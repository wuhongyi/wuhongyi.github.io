<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Geant4 Optical User&#39;s Guide | Hongyi Wu(吴鸿毅)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="&amp;lt;!-- README.md --- 
;; 
;; Description: 
;; Author: Hongyi Wu(吴鸿毅)
;; Email: wuhongyi@qq.com 
;; Created: 六 1月 30 12:47:57 2016 (+0800)
;; Last-Updated: 六 7月 16 20:02:48 2016 (+0800)
;;           By:">
<meta property="og:type" content="article">
<meta property="og:title" content="Geant4 Optical User's Guide">
<meta property="og:url" content="http://wuhongyi.github.io/CodeProject/ProjectGeant4/Geant4OpticalREADME/index.html">
<meta property="og:site_name" content="Hongyi Wu(吴鸿毅)">
<meta property="og:description" content="&amp;lt;!-- README.md --- 
;; 
;; Description: 
;; Author: Hongyi Wu(吴鸿毅)
;; Email: wuhongyi@qq.com 
;; Created: 六 1月 30 12:47:57 2016 (+0800)
;; Last-Updated: 六 7月 16 20:02:48 2016 (+0800)
;;           By:">
<meta property="og:updated_time" content="2016-10-29T01:26:25.443Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Geant4 Optical User's Guide">
<meta name="twitter:description" content="&amp;lt;!-- README.md --- 
;; 
;; Description: 
;; Author: Hongyi Wu(吴鸿毅)
;; Email: wuhongyi@qq.com 
;; Created: 六 1月 30 12:47:57 2016 (+0800)
;; Last-Updated: 六 7月 16 20:02:48 2016 (+0800)
;;           By:">
  
    <link rel="alternative" href="/atom.xml" title="Hongyi Wu(吴鸿毅)" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="img/why.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Hongyi Wu</a></h1>
		</hgroup>

		
		<p class="header-subtitle">吴鸿毅</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Menu</li>
						<li>Tags</li>
						
						<li>Link</li>
						
						
						<li>AboutMe</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">Home</a></li>
				        
							<li><a href="/archives">Archives</a></li>
				        
							<li><a href="/tags/Linux">Linux</a></li>
				        
							<li><a href="/tags/Nuclearphysics">Nuclearphysics</a></li>
				        
							<li><a href="/about">AboutMe</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/wuhongyi" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/wuhongyi" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="/#" title="rss">rss</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/C-C/" style="font-size: 16px;">C/C++</a> <a href="/tags/Chrome/" style="font-size: 10px;">Chrome</a> <a href="/tags/CodeProject/" style="font-size: 10px;">CodeProject</a> <a href="/tags/GCC/" style="font-size: 10px;">GCC</a> <a href="/tags/GDB/" style="font-size: 10px;">GDB</a> <a href="/tags/Geant4/" style="font-size: 14px;">Geant4</a> <a href="/tags/Geant4-ROOT/" style="font-size: 12px;">Geant4-ROOT</a> <a href="/tags/Github/" style="font-size: 10px;">Github</a> <a href="/tags/Latex/" style="font-size: 10px;">Latex</a> <a href="/tags/Linux/" style="font-size: 20px;">Linux</a> <a href="/tags/Makefile/" style="font-size: 10px;">Makefile</a> <a href="/tags/Nuclearphysics/" style="font-size: 12px;">Nuclearphysics</a> <a href="/tags/Octopress/" style="font-size: 10px;">Octopress</a> <a href="/tags/PATH/" style="font-size: 10px;">PATH</a> <a href="/tags/QStarDict/" style="font-size: 10px;">QStarDict</a> <a href="/tags/RTFM/" style="font-size: 10px;">RTFM</a> <a href="/tags/Software/" style="font-size: 18px;">Software</a> <a href="/tags/TEST/" style="font-size: 10px;">TEST</a> <a href="/tags/TH1/" style="font-size: 10px;">TH1</a> <a href="/tags/Windows/" style="font-size: 10px;">Windows</a> <a href="/tags/cmake/" style="font-size: 10px;">cmake</a> <a href="/tags/cryptsetup/" style="font-size: 10px;">cryptsetup</a> <a href="/tags/essay/" style="font-size: 12px;">essay</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/rand/" style="font-size: 10px;">rand</a> <a href="/tags/rar/" style="font-size: 10px;">rar</a> <a href="/tags/shell/" style="font-size: 12px;">shell</a> <a href="/tags/string/" style="font-size: 10px;">string</a> <a href="/tags/texlive/" style="font-size: 10px;">texlive</a> <a href="/tags/vector/" style="font-size: 10px;">vector</a> <a href="/tags/wiznote/" style="font-size: 10px;">wiznote</a> <a href="/tags/xerces/" style="font-size: 10px;">xerces</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://http://www.pku.edu.cn/">PekingUniversity</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://geant4.cern.ch/">Geant4</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://root.cern.ch/drupal/">ROOT</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cplusplus.com/">C++</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">人民，只有人民，才是创造世界历史的动力！</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Hongyi Wu</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="img/why.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Hongyi Wu</h1>
			</hgroup>
			
			<p class="header-subtitle">吴鸿毅</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">Home</a></li>
		        
					<li><a href="/archives">Archives</a></li>
		        
					<li><a href="/tags/Linux">Linux</a></li>
		        
					<li><a href="/tags/Nuclearphysics">Nuclearphysics</a></li>
		        
					<li><a href="/about">AboutMe</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/wuhongyi" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/wuhongyi" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="/#" title="rss">rss</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-CodeProject/ProjectGeant4/Geant4OpticalREADME" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/CodeProject/ProjectGeant4/Geant4OpticalREADME/" class="article-date">
  	<time datetime="2016-01-30T04:47:57.000Z" itemprop="datePublished">2016-01-30</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Geant4 Optical User&#39;s Guide
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Geant4/">Geant4</a></li></ul>
	</div>

        

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- README.md --- 
;; 
;; Description: 
;; Author: Hongyi Wu(吴鸿毅)
;; Email: wuhongyi@qq.com 
;; Created: 六 1月 30 12:47:57 2016 (+0800)
;; Last-Updated: 六 7月 16 20:02:48 2016 (+0800)
;;           By: Hongyi Wu(吴鸿毅)
;;     Update #: 31
;; URL: http://wuhongyi.cn -->
<h1 id="材料的光学属性">材料的光学属性</h1><p>通过 G4MaterialPropertiesTable 与 G4Material 连接。</p>
<p>其中，必须要设置的参数：SCINTILLATIONYIELD、RINDEX、ABSLENGTH。</p>
<p>没有 FASTCOMPONENT、SLOWCOMPONENT 属性不产生光子。</p>
<h1 id="提供的光学过程">提供的光学过程</h1><ul>
<li>G4OpAbsorption</li>
<li>G4OpRayleigh</li>
<li>G4OpMieHG</li>
<li>G4OpBoundaryProcess</li>
<li>G4OpWLS</li>
<li>G4Scintillation</li>
<li>G4EmSaturation</li>
<li>G4Cerenkov</li>
</ul>
<a id="more"></a>
<h2 id="Cerenkov">Cerenkov</h2><p>The radiation of Cerenkov light occurs when a charged particle moves through a dispersive medium faster than<br>the group velocity of light in that medium. Photons are emitted on the surface of a cone, whose opening angle<br>with respect to the particle’s instantaneous direction decreases as the particle slows down. At the same time, the<br>frequency of the photons emitted increases, and the number produced decreases. When the particle velocity drops<br>below the local speed of light, the radiation ceases and the emission cone angle collapses to zero. The photons<br>produced by this process have an inherent polarization perpendicular to the cone’s surface at production.</p>
<p>The time and position of Cerenkov photon emission are calculated from quantities known at the beginning of a<br>charged particle’s step. The step is assumed to be rectilinear even in the presence of a magnetic field. The user may<br>limit the step size by specifying a maximum (average) number of Cerenkov photons created during the step, using<br>the <strong>SetMaxNumPhotonsPerStep(const G4int NumPhotons)</strong> method. The actual number generated<br>will necessarily be different due to the Poissonian nature of the production. In the present implementation, the<br>production density of photons is distributed evenly along the particle’s track segment, even if the particle has<br>slowed significantly during the step. The step can also be limited with the <strong>SetMaxBetaChangePerStep</strong><br>method, where the argument is the allowed change in percent).</p>
<h2 id="Scintillation">Scintillation</h2><p>Every scintillating material has a characteristic light yield, <strong>SCINTILLATIONYIELD</strong>, and an intrinsic resolution,<br><strong>RESOLUTIONSCALE</strong>, which generally broadens the statistical distribution of generated photons. A wider<br>intrinsic resolution is due to impurities which are typical for doped crystals like NaI(Tl) and CsI(Tl). On the<br>other hand, the intrinsic resolution can also be narrower when the Fano factor plays a role. The actual number<br>of emitted photons during a step fluctuates around the mean number of photons with a width given by<br><strong>ResolutionScale*sqrt(MeanNumberOfPhotons)</strong>. The average light yield, <strong>MeanNumberOfPhotons</strong>,<br>has a linear dependence on the local energy deposition, but it may be different for minimum ionizing and<br>non-minimum ionizing particles.</p>
<p>A scintillator is also characterized by its photon emission spectrum and by the exponential decay of its time spectrum.<br>In GEANT4 the scintillator can have a fast and a slow component. The relative strength of the fast component<br>as a fraction of total scintillation yield is given by the <strong>YIELDRATIO</strong>. Scintillation may be simulated by specifying<br>these empirical parameters for each material. It is sufficient to specify in the user’s <strong>DetectorConstruction</strong><br>class a relative spectral distribution as a function of photon energy for the scintillating material. </p>
<p>In cases where the scintillation yield of a scintillator depends on the particle type, different scintillation processes<br>may be defined for them. How this yield scales to the one specified for the material is expressed with the <strong>ScintillationYieldFactor</strong><br>in the user’s <strong>PhysicsList</strong>. In those cases where the<br>fast to slow excitation ratio changes with particle type, the method <strong>SetScintillationExcitationRatio</strong><br>can be called for each scintillation process (see the advanced underground_physics example). This overwrites the<br><strong>YieldRatio</strong> obtained from the <strong>G4MaterialPropertiesTable</strong>.</p>
<p>A Gaussian-distributed number of photons is generated according to the energy lost during the<br>step. A resolution scale of 1.0 produces a statistical fluctuation around the average yield set with<br><strong>AddConstProperty(“SCINTILLATIONYIELD”)</strong>, while values &gt; 1 broaden the fluctuation. A value of<br>zero produces no fluctuation. Each photon’s frequency is sampled from the empirical spectrum. The photons<br>originate evenly along the track segment and are emitted uniformly into 4π with a random linear polarization and at<br>times characteristic for the scintillation component.</p>
<p>When there are multiple scintillators in the simulation and/or when the scintillation yield is a non-linear function of<br>the energy deposited, the user can also define an array of total scintillation light yields as a function of the energy<br>deposited and particle type. The available particles are protons, electrons, deuterons, tritons, alphas, and carbon<br>ions. These are the particles known to significantly effect the scintillation light yield, of for example, BC501A<br>(NE213/EJ301) liquid organic scintillator and BC420 plastic scintillator as function of energy deposited.</p>
<p>The method works as follows:</p>
<ul>
<li><p>In the user’s physics lists, the user must set a G4bool flag that allows scintillation light emission to depend<br>on the energy deposited by particle type: <strong>theScintProcess-&gt;SetScintillationByParticleType(true);</strong></p>
</li>
<li><p>The user must also specify and add, via the AddProperty method of the MPT, the scintillation light yield as<br>function of incident particle energy with new keywords, for example: PROTONSCINTILLATIONYIELD<br>etc. and pairs of protonEnergy and scintLightYield.</p>
</li>
</ul>
<h3 id="参数设置">参数设置</h3><p>产生光子必须有：</p>
<ul>
<li>FASTCOMPONENT、SLOWCOMPONENT</li>
<li>RESOLUTIONSCALE</li>
</ul>
<p>其中FASTCOMPONENT、SLOWCOMPONENT至少有一个。</p>
<hr>
<p>FASTCOMPONENT、SLOWCOMPONENT分情况（里面还涉及考虑不考虑FiniteRiseTime）：</p>
<ul>
<li>只有FASTCOMPONENT时<ul>
<li>FASTTIMECONSTANT ：发光延迟为 -FASTTIMECONSTANT*std::log(G4UniformRand())</li>
<li>如果FiniteRiseTime时，FASTSCINTILLATIONRISETIME ：发光延迟为sample_time(FASTSCINTILLATIONRISETIME, FASTTIMECONSTANT)</li>
</ul>
</li>
<li>只有SLOWCOMPONENT时<ul>
<li>SLOWTIMECONSTANT ：发光延迟为 -SLOWTIMECONSTANT*std::log(G4UniformRand())</li>
<li>如果FiniteRiseTime时，SLOWSCINTILLATIONRISETIME ：发光延迟为sample_time(SLOWSCINTILLATIONRISETIME, SLOWTIMECONSTANT)</li>
</ul>
</li>
<li>两者都有时。将计算光子数按比例分开，然后按照按照以上单成分计算<ul>
<li>YIELDRATIO（快成分所占比例）</li>
<li>ExcitationRatio ：如果 ( fExcitationRatio == 1.0 || fExcitationRatio == 0.0)，快成分所占比例为 std::min(yieldRatio,1.0)；如果 （0&lt;fExcitationRatio&lt;1），快成分所占比例为 std::min(fExcitationRatio,1.0)。</li>
</ul>
</li>
</ul>
<p>如果只有快慢成分中的一种（占主要，另一种可以忽略），如果忽略上升时间，则发光延迟为该成分衰减时间分布的抽样，如果考虑上升时间，那么发光延迟为上升、衰减时间分布的抽样。</p>
<p>位置在步长内均匀抽样，时间为粒子到该位置的时间加上发光时间延迟。方向各向同性，确定偏振（polarization），能量抽样按照闪光光谱抽样。</p>
<hr>
<p>发光与粒子种类有关时：</p>
<ul>
<li>PROTONSCINTILLATIONYIELD</li>
<li>DEUTERONSCINTILLATIONYIELD</li>
<li>TRITONSCINTILLATIONYIELD</li>
<li>ALPHASCINTILLATIONYIELD</li>
<li>IONSCINTILLATIONYIELD</li>
<li>ELECTRONSCINTILLATIONYIELD</li>
</ul>
<hr>
<p>发光与粒子种类无关时（分考虑不考虑EmSaturation）：</p>
<ul>
<li>SCINTILLATIONYIELD</li>
<li>YieldFactor</li>
</ul>
<hr>
<p>能损计算的光子数考虑展宽：</p>
<p>MeanNumberOfPhotons &gt; 10 时，sigma = ResolutionScale * std::sqrt(MeanNumberOfPhotons); NumPhotons = G4int(G4RandGauss::shoot(MeanNumberOfPhotons,sigma)+0.5);<br>MeanNumberOfPhotons &lt;= 10 时，NumPhotons = G4int(G4Poisson(MeanNumberOfPhotons));<br>NumPhotons &lt;= 0， return unchanged particle and no secondaries。</p>
<hr>
<h2 id="Wavelength_Shifting">Wavelength Shifting</h2><p>Wavelength Shifting (WLS) fibers are used in many high-energy particle physics experiments. They absorb light<br>at one wavelength and re-emit light at a different wavelength and are used for several reasons. For one, they tend<br>to decrease the self-absorption of the detector so that as much light reaches the PMTs as possible. WLS fibers are<br>also used to match the emission spectrum of the detector with the input spectrum of the PMT.</p>
<p>A WLS material is characterized by its photon absorption and photon emission spectrum and by a possible time<br>delay between the absorption and re-emission of the photon. Wavelength Shifting may be simulated by specifying<br>these empirical parameters for each WLS material in the simulation. It is sufficient to specify in the user’s<br><strong>DetectorConstruction</strong> class a relative spectral distribution as a function of photon energy for the WLS material.<br>WLSABSLENGTH is the absorption length of the material as a function of the photon’s energy. WLSCOMPONENT<br>is the relative emission spectrum of the material as a function of the photon’s energy, and<br>WLSTIMECONSTANT accounts for any time delay which may occur between absorption and re-emission of the photon.</p>
<p>The process is defined in the PhysicsList in the usual way. The process class name is G4OpWLS. It should be<br>instantiated with theWLSProcess = new G4OpWLS(“OpWLS”) and attached to the process manager of the optical<br>photon as a DiscreteProcess. The way the WLSTIMECONSTANT is used depends on the time profile method<br>chosen by the user. If in the PhysicsList the WLSProcess-&gt;UseTimeGenerator(“exponential”) option is set, the<br>time delay between absorption and re-emission of the photon is sampled from an exponential distribution, with the<br>decay term equal to WLSTIMECONSTANT. If, on the other hand, theWLSProcess-&gt;UseTimeGenerator(“delta”)<br>is chosen, the time delay is a delta function and equal to WLSTIMECONSTANT. The default is “delta” in case<br>the G4OpWLS::UseTimeGenerator(const G4String name) method is not used.</p>
<h2 id="Absorption">Absorption</h2><p>The implementation of optical photon bulk absorption, <strong>G4OpAbsorption</strong>, is trivial in that the process merely<br>kills the particle. The procedure requires the user to fill the relevant <strong>G4MaterialPropertiesTable</strong> with<br>empirical data for the <strong>absorption</strong> length, using ABSLENGTH as the property key in the public method <strong>AddProperty</strong>.<br>The absorption length is the average distance traveled by a photon before being absorpted by the medium;<br>i.e. it is the mean free path returned by the <strong>GetMeanFreePath</strong> method.</p>
<h2 id="Rayleigh_Scattering">Rayleigh Scattering</h2><p>The differential cross section in Rayleigh scattering, is proportional to 1+cos2(θ), where θ is the polar of<br>the new polarization vector with respect to the old polarization vector. The <strong>G4OpRayleigh</strong> scattering process<br>samples this angle accordingly and then calculates the scattered photon’s new direction by requiring that it be<br>perpendicular to the photon’s new polarization in such a way that the final direction, initial and final polarizations<br>are all in one plane. This process thus depends on the particle’s polarization (spin). The photon’s polarization is<br>a data member of the <strong>G4DynamicParticle</strong> class.</p>
<p>A photon which is not assigned a polarization at production, either via the <strong>SetPolarization</strong> method<br>of the <strong>G4PrimaryParticle</strong> class, or indirectly with the <strong>SetParticlePolarization</strong> method of the<br><strong>G4ParticleGun</strong> class, may not be Rayleigh scattered. Optical photons produced by the <strong>G4Cerenkov</strong> process<br>have inherently a polarization perpendicular to the cone’s surface at production. Scintillation photons have a<br>random linear polarization perpendicular to their direction.</p>
<p>The process requires a <strong>G4MaterialPropertiesTable</strong> to be filled by the user with Rayleigh scattering length<br>data. The Rayleigh scattering attenuation length is the average distance traveled by a photon before it is Rayleigh<br>scattered in the medium and it is the distance returned by the <strong>GetMeanFreePath</strong> method. The <strong>G4OpRayleigh</strong><br>class provides a <strong>RayleighAttenuationLengthGenerator</strong> method which calculates the attenuation coefficient<br>of a medium following the Einstein-Smoluchowski formula whose derivation requires the use of statistical<br>mechanics, includes temperature, and depends on the isothermal compressibility of the medium. This generator is<br>convenient when the Rayleigh attenuation length is not known from measurement but may be calculated from first<br>principles using the above material constants. For a medium named Water and no Rayleigh scattering attenutation<br>length specified by the user, the program automatically calls the <strong>RayleighAttenuationLengthGenerator</strong><br>which calculates it for 10 degrees Celsius liquid water.</p>
<h2 id="Mie_Scattering">Mie Scattering</h2><p>Mie Scattering (or Mie solution) is an analytical solution of Maxwell’s equations for scattering of optical photons<br>by spherical particles. It is significant only when the radius of the scattering object is of order of the wave length.<br>The analytical expressions for Mie Scattering are very complicated since they are a series sum of Bessel functions.<br>One common approximation made is call Henyey-Greenstein (HG). The implementation in Geant4 follows the HG<br>approximation (for details see the Physics Reference Manual) and the treatment of polarization and momentum<br>are similar to that of Rayleigh scattering. We require the final polarization direction to be perpendicular to the<br>momentum direction. We also require the final momentum, initial polarization and final polarization to be in the<br>same plane.</p>
<p>The process requires a G4MaterialPropertiesTable to be filled by the user with Mie scattering length data (entered<br>with the name: MIEHG) analogous to Rayleigh scattering. The Mie scattering attenuation length is the average<br>distance traveled by a photon before it is Mie scattered in the medium and it is the distance returned by the<br>GetMeanFreePath method. In practice, the user not only needs to provide the attenuation length of Mie scattering, but<br>also needs to provide the constant parameters of the approximation: g_f, g_b, and r_f. (with AddConstProperty<br>and with the names: MIEHG_FORWARD, MIEHG_BACKWARD, and MIEHG_FORWARD_RATIO, respec-<br>tively; see Novice Example N06.)</p>
<h1 id="Boundary_Process">Boundary Process</h1><p>For the simple case of a perfectly smooth interface between two dielectric materials, all the user needs to provide<br>are the refractive indices of the two materials stored in their respective <strong>G4MaterialPropertiesTable</strong>. In<br>all other cases, the optical boundary process design relies on the concept of <em>surfaces</em>. The information is split into<br>two classes. One class in the material category keeps information about the physical properties of the surface itself,<br>and a second class in the geometry category holds pointers to the relevant physical and logical volumes involved<br>and has an association to the physical class. Surface objects of the second type are stored in a related table and<br>can be retrieved by either specifying the two ordered pairs of physical volumes touching at the surface, or by the<br>logical volume entirely surrounded by this surface. The former is called a <em>border surface</em> while the latter is referred<br>to as the <em>skin surface</em>. This second type of surface is useful in situations where a volume is coded with a reflector<br>and is placed into many different mother volumes. A limitation is that the skin surface can only have one and<br>the same optical property for all of the enclosed volume’s sides. The border surface is an ordered pair of physical<br>volumes, so in principle, the user can choose different optical properties for photons arriving from the reverse side<br>of the same interface. For the optical boundary process to use a border surface, the two volumes must have been<br>positioned with <strong>G4PVPlacement</strong>. The ordered combination can exist at many places in the simulation. When<br>the surface concept is not needed, and a perfectly smooth surface exists beteen two dielectic materials, the only<br>relevant property is the index of refraction, a quantity stored with the material, and no restriction exists on how<br>the volumes were positioned.</p>
<p>When an optical photon arrives at a boundary it is absorbed if the medium of the volume being left behind has no<br>index of refraction defined. A photon is also absorbed in case of a dielectric-dielectric polished or ground surface<br>when the medium about to be entered has no index of refraction. It is absorbed for backpainted surfaces when the<br>surface has no index of refraction. If the geometry boundary has a <em>border surface</em> this surface takes precedence,<br>otherwise the program checks for <em>skin surfaces</em>. The <em>skin surface</em> of the daughter volume is taken if a daughter<br>volume is entered else the program checks for a <em>skin surface</em> of the current volume. When the optical photon leaves<br>a volume without entering a daughter volume the <em>skin surface</em> of the current volume takes precedence over that<br>of the volume about to be entered.</p>
<p>The physical surface object also specifies which model the boundary process should use to simulate interactions<br>with that surface. In addition, the physical surface can have a material property table all its own. The usage of this<br>table allows all specular constants to be wavelength dependent. In case the surface is painted or wrapped (but not a<br>cladding), the table may include the thin layer’s index of refraction. This allows the simulation of boundary effects<br>at the intersection between the medium and the surface layer, as well as the Lambertian reflection at the far side<br>of the thin layer. This occurs within the process itself and does not invoke the <strong>G4Navigator</strong>. Combinations of<br>surface finish properties, such as <em>polished</em> or <em>ground</em> and <em>front painted</em> or <em>back painted</em>, enumerate the different<br>situations which can be simulated.</p>
<p>When a photon arrives at a medium boundary its behavior depends on the nature of the two materials that join at<br>that boundary. Medium boundaries may be formed between two dielectric materials or a dielectric and a metal.<br>In the case of two dielectric materials, the photon can undergo total internal reflection, refraction or reflection,<br>depending on the photon’s wavelength, angle of incidence, and the refractive indices on both sides of the boundary.<br>Furthermore, reflection and transmission probabilites are sensitive to the state of linear polarization. In the case of<br>an interface between a dielectric and a metal, the photon can be absorbed by the metal or reflected back into the<br>dielectric. If the photon is absorbed it can be detected according to the photoelectron efficiency of the metal.</p>
<p>As expressed in Maxwell’s equations, Fresnel reflection and refraction are intertwined through their relative<br>probabilities of occurrence. Therefore neither of these processes, nor total internal reflection, are viewed as individual<br>processes deserving separate class implementation. Nonetheless, an attempt was made to adhere to the abstraction<br>of having independent processes by splitting the code into different methods where practicable.</p>
<p>One implementation of the <strong>G4OpBoundaryProcess</strong> class employs the UNIFIED model [A. Levin and C.<br>Moisan, A More Physical Approach to Model the Surface Treatment of Scintillation Counters and its Implementation<br>into DETECT, TRIUMF Preprint TRI-PP-96-64, Oct. 1996] of the DETECT program [G.F. Knoll, T.F. Knoll<br>and T.M. Henderson, Light Collection Scintillation Detector Composites for Neutron Detection, IEEE Trans.<br>Nucl. Sci., 35 (1988) 872.]. It applies to dielectric-dielectric interfaces and tries to provide a realistic simulation,<br>which deals with all aspects of surface finish and reflector coating. The surface may be assumed as smooth and<br>covered with a metallized coating representing a specular reflector with given reflection coefficient, or painted<br>with a diffuse reflecting material where Lambertian reflection occurs. The surfaces may or may not be in optical<br>contact with another component and most importantly, one may consider a surface to be made up of micro-facets<br>with normal vectors that follow given distributions around the nominal normal for the volume at the impact point.</p>
<p>For very rough surfaces, it is possible for the photon to inversely aim at the same surface again after reflection<br>of refraction and so multiple interactions with the boundary are possible within the process itself and without the<br>need for relocation by <strong>G4Navigator</strong>.</p>
<p>The UNIFIED model provides for a range of different reflection mechanisms. The specular lobe<br>constant represents the reflection probability about the normal of a micro facet. The specular spike constant, in<br>turn, illustrates the probability of reflection about the average surface normal. The diffuse lobe constant is for the<br>probability of internal Lambertian reflection, and finally the back-scatter spike constant is for the case of several<br>reflections within a deep groove with the ultimate result of exact back-scattering. The four probabilities must<br>add up to one, with the diffuse lobe constant being implicit. The reader may consult the reference for a thorough<br>description of the model.</p>
<p>The original GEANT3.21 implementation of this process is also available via the GLISUR methods flag. [GEANT<br>Detector Description and Simulation Tool, Application Software Group, Computing and Networks Division,<br>CERN, PHYS260-6 tp 260-7.].</p>
<p>The reflectivity off a metal surface can also be calculated by way of a complex index of refraction. Instead of<br>storing the REFLECTIVITY directly, the user stores the real part (REALRINDEX) and the imaginary part (IMAGINARYRINDEX)<br>as a function of photon energy separately in the G4MaterialPropertyTable. Geant4 then calculates<br>the reflectivity depending on the incident angle, photon energy, degree of TE and TM polarization, and this<br>complex refractive index.</p>
<p>The program defaults to the GLISUR model and <em>polished</em> surface finish when no specific model and surface<br>finish is specified by the user. In the case of a dielectric-metal interface, or when the GLISUR model is<br>specified, the only surface finish options available are polished or ground. For dielectric-metal surfaces, the<br><strong>G4OpBoundaryProcess</strong> also defaults to unit reflectivity and zero detection efficiency. In cases where the<br>user specifies the UNIFIED model, but does not otherwise specify the model reflection probability<br>constants, the default becomes Lambertian reflection.</p>
<p>Martin Janecek and Bill Moses (Lawrence Berkeley National Laboratory) built an instrument for measuring the<br>angular reflectivity distribution inside of BGO crystals with common surface treatments and reflectors applied.<br>These results have been incorporate into the Geant4 code. A third class of reflection type besides dielectric-metal<br>and dielectric-dielectric is added: dielectric-LUT. The distributions have been converted to 21 look-up-tables<br>(LUT); so far for 1 scintillator material (BGO) x 3 surface treatments x 7 reflector materials. The modified code<br>allows the user to specify the surface treatment (rough-cut, chemically etched, or mechanically polished), the<br>attached reflector (Lumirror, Teflon, ESR film, Tyvek, or TiO2 paint), and the bonding type (air-coupled or glued).<br>The glue used is MeltMount, and the ESR film used is VM2000. Each LUT consists of measured angular distributions<br>with 4deg by 5deg resolution in theta and phi, respectively, for incidence angles from 0 to 90 degrees, in 1 degree<br>steps. The code might in the future be updated by adding more LUTs, for instance, for other scintillating materials<br>(such as LSO or NaI). To use these LUT the user has to download them from Geant4 Software Download and<br>set an environment variable, <strong>G4REALSURFACEDATA</strong>, to the directory of <strong>geant4/data/RealSurface1.0</strong>.<br>For details see: M. Janecek, W. W. Moses, IEEE Trans. Nucl. Sci. 57 (3) (2010) 964-970.</p>
<!-- README.md ends here -->

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/CodeProject/ProjectGeant4/Geant4AuthorizeREADME/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          吴鸿毅 CodeProject - How To Authorize(Geant4)
        
      </div>
    </a>
  
  
    <a href="/CodeProject/CodeProjectManual/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">吴鸿毅 CodeProject使用说明书</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>






<section id="comments">
  <div id="disqus_thread"></div>
    <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'wuhongyi'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>

</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-center">
    		&copy; 2017 Hongyi Wu
    	</div>
      	<!-- <div class="footer-right"> -->
      	<!-- 	<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten -->
      	<!-- </div> -->
    </div>
  </div>
</footer>

    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>